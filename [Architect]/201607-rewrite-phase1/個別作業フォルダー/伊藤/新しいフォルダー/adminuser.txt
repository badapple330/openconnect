<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@page import="java.sql.*"%>
<%@ taglib prefix="s" uri="/struts-tags"%>
<%!// サーブレットのinitメソッドに相当
	public void jspInit() {
		try {
			// JDBCドライバをロード
			Class.forName("com.mysql.jdbc.Driver");
		} catch (Exception e) {
			e.printStackTrace();
		}
	}%>
<!DOCTYPE html>
<html>
<head>
<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
<link rel="stylesheet" href="css/admin_user.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>adminuser</title>
<script>
	$(function() {
		var page = 0;
		function draw() {
			$('#page').html(page + 1);
			$('tr').hide();
			$('tr:first,tr:gt(' + page * 10 + '):lt(10)').show();
		}
		$('#prev').click(function() {
			if (page > 0) {
				page--;
				draw();
			}
		});
		$('#next').click(function() {
			if (page < ($('tr').size() - 1) / 10 - 1) {
				page++;
				draw();
			}
		});
		draw();
	});
</script>
</head>

<body>
	<P>利用者一覧</P>
	＊チェックボックスに、チェックをいれて編集・削除を行う。
	<table class="mytable" border='1'>
		<tr>
			<th>ユーザーID</th>
			<th>name</th>
			<th>email</th>
			<th>削除/編集</th>
		</tr>

		<%
			// データベースへのアクセス開始
			Connection con = null;
			Statement stmt = null;
			ResultSet rs = null;
			try {
				// データベースに接続するConnectionオブジェクトの取得
				con = DriverManager.getConnection("jdbc:mysql://localhost/rewrite", "root", "z2789c6981");
				// データベース操作を行うためのStatementオブジェクトの取得
				stmt = con.createStatement();
				// SQL()を実行して、結果を得る
				rs = stmt.executeQuery("select user_id, name, email from user");

				// 得られた結果をレコードごとに表示
				while (rs.next()) {
		%>
		<tr>
			<%-- userのNOフィールドを表示 --%>
			<td><input type="text" name="user_id"
				value=<%=rs.getInt("user_id")%>></td>
			<%-- userのNAMEフィールドを表示 --%>
			<td><input type="text" name="name"
				value="<%=rs.getString("name")%>"></td>
			<%-- userのemailフィールドを表示 --%>
			<td><input type="text" name="email"
				value="<%=rs.getString("email")%>"></td>
			<%-- userのemailフィールドを表示 --%>
			<td><input type="checkbox" name="check"
				value="<%=rs.getInt("user_id")%>"></td>
		</tr>
		<%
			}

			} catch (Exception e) {
				e.printStackTrace();
			} finally {
				// データベースとの接続をクローズ
				try {
					rs.close();
				} catch (Exception e) {
				}
				try {
					stmt.close();
				} catch (Exception e) {
				}
				try {
					con.close();
				} catch (Exception e) {
				}
			}
		%>
	</table>
	<div class=pager>
		<span id="prev">prev</span> <span id="page"></span> <span id="next">next</span>
	</div>
	<br>
	<input type="button" value="削除">
	<input type="button" value="編集">


</body>
</html>